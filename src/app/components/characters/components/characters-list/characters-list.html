<section class="hp-characters">
  <header class="hp-characters__header">
    <div class="hp-characters__title">
      <h1>Harry Potter â€” Characters</h1>
      <p class="hp-characters__subtitle">
        Une galerie immersive : portraits, maisons, baguettes, patronus.
      </p>
    </div>

    @if (characters().length > 0) {
      <div class="hp-characters__meta">
        <span class="hp-count">
          <span class="hp-count__spark" aria-hidden="true">âœ¦</span>
          <strong>{{ characters().length }}</strong>
          <span>characters</span>
        </span>
      </div>
    }
  </header>

  @if (characters().length === 0) {
    <div class="hp-empty">
      <div class="hp-empty__orb" aria-hidden="true"></div>
      <div class="hp-empty__icon" aria-hidden="true">ðŸª„</div>
      <div class="hp-empty__title">Aucun personnage trouvÃ©</div>
      <div class="hp-empty__desc">VÃ©rifie ton appel API ou tes filtres.</div>
    </div>
  } @else {
    <div class="hp-grid">
      @for (character of characters(); track character.id) {
        <article
          (click)="goToCharacterDetail(character.id)"
          class="hp-card"
          [class.hp-card--gryffindor]="character.house === 'Gryffindor'"
          [class.hp-card--slytherin]="character.house === 'Slytherin'"
          [class.hp-card--ravenclaw]="character.house === 'Ravenclaw'"
          [class.hp-card--hufflepuff]="character.house === 'Hufflepuff'"
        >
          <!-- Media -->
          <div class="hp-card__media">
            @if (character.image) {
              <img class="hp-card__img" [src]="character.image" [alt]="character.name" loading="lazy" />
            } @else {
              <div class="hp-card__img hp-card__img--fallback" aria-hidden="true">
                <div class="hp-card__fallbackGlyph">âœ§</div>
                <div class="hp-card__fallbackText">No portrait</div>
              </div>
            }

            <div class="hp-card__veil" aria-hidden="true"></div>
            <div class="hp-card__sparkles" aria-hidden="true"></div>

            <div class="hp-card__top">
              @if (character.house) {
                <span class="hp-house">
                  <span class="hp-house__dot" aria-hidden="true"></span>
                  {{ character.house }}
                </span>
              } @else {
                <span class="hp-house hp-house--none">
                  <span class="hp-house__dot" aria-hidden="true"></span>
                  Unknown House
                </span>
              }

              <span
                class="hp-life"
                [class.hp-life--alive]="character.alive"
                [class.hp-life--dead]="!character.alive"
              >
                {{ character.alive ? 'Alive' : 'Deceased' }}
              </span>
            </div>

            <div class="hp-card__bottom">
              <h2 class="hp-card__name">{{ character.name }}</h2>

              <div class="hp-card__chips">
                <span class="hp-chip">{{ character.species }}</span>
                <span class="hp-chip">{{ character.gender }}</span>

                @if (character.hogwartsStudent) {
                  <span class="hp-chip hp-chip--accent">Student</span>
                }
                @if (character.hogwartsStaff) {
                  <span class="hp-chip hp-chip--accent">Staff</span>
                }
                @if (character.wizard) {
                  <span class="hp-chip hp-chip--accent">Wizard</span>
                }
              </div>
            </div>
          </div>

          <!-- Body -->
          <div class="hp-card__body">
            <div class="hp-row">
              <span class="hp-k">Actor</span>
              <span class="hp-v">{{ character.actor || 'â€”' }}</span>
            </div>

            <div class="hp-row">
              <span class="hp-k">Ancestry</span>
              <span class="hp-v">{{ character.ancestry || 'â€”' }}</span>
            </div>

            <div class="hp-row">
              <span class="hp-k">Eyes / Hair</span>
              <span class="hp-v">
                {{ character.eyeColour || 'â€”' }} / {{ character.hairColour || 'â€”' }}
              </span>
            </div>

            <div class="hp-row">
              <span class="hp-k">Birth</span>
              <span class="hp-v">
                @if (character.dateOfBirth) {
                  {{ character.dateOfBirth }}
                } @else if (character.yearOfBirth) {
                  {{ character.yearOfBirth }}
                } @else {
                  â€”
                }
              </span>
            </div>

            <div class="hp-row">
              <span class="hp-k">Patronus</span>
              <span class="hp-v">{{ character.patronus || 'â€”' }}</span>
            </div>

            <div class="hp-wand">
              <div class="hp-wand__icon" aria-hidden="true">ðŸª„</div>
              <div class="hp-wand__text">
                <div class="hp-wand__title">Wand</div>
                @if (character.wand?.wood || character.wand?.core || character.wand?.length) {
                  <div class="hp-wand__desc">
                    {{ character.wand?.wood || 'â€”' }}
                    <span class="hp-sep" aria-hidden="true">â€¢</span>
                    {{ character.wand?.core || 'â€”' }}
                    <span class="hp-sep" aria-hidden="true">â€¢</span>
                    @if (character.wand?.length) { {{ character.wand.length }} } @else { â€” } in
                  </div>
                } @else {
                  <div class="hp-wand__desc">â€”</div>
                }
              </div>
            </div>
          </div>
        </article>
      }
    </div>
  }
</section>
